---
platform: linux

image_resource:
  type: docker-image
  source:
    repository: ruby

inputs:
- name: specs

params:
  OM_TARGET:
  OM_USERNAME:
  OM_PASSWORD:
  OM_SKIP_SSL_VALIDATION:
  SPECS_SUBDIR: .
  VERSION: 3.9.0
  GEM_SOURCE: https://rubygems.org

run:
  path: /bin/bash
  args:
  - -c
  - |
    gem install --no-document --source ${GEM_SOURCE} --version ${VERSION} inspec
    inspec exec --no-color specs/${SPECS_SUBDIR}